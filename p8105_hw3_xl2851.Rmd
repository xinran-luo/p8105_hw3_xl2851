---
title: "p8105_hw3_xl2851"
output: github_document
---
# problem 1
## 1.1 How many aisles are there, and which aisles are the most items ordered from?
```{r}
library(p8105.datasets)
library(tidyr)
library(tidyverse)
data("instacart")

```

```{r}
aisle_count=
instacart %>%
  group_by(aisle) %>%
  summarize(number_of_items=n())%>%
  arrange(desc(number_of_items))
```

There are 134 aisles. Fresh vegetables are the most items ordered from.

## 1.2 Make a plot that shows the number of items ordered in each aisle, limiting this to aisles with more than 10000 items ordered.
```{r}
plot_aisle =
  aisle_count %>%
  filter(number_of_items>10000)%>%
  ggplot(aes(x=number_of_items, y=aisle))

plot_aisle+geom_point()
```

## 1.3 Make a table showing the three most popular items in each of the aisles
```{r}
  instacart %>%
  filter(aisle == c("baking ingredients","dog food care","packaged vegetables fruits"))%>%
  group_by(aisle)%>%
  count(product_name, name="num_of_items")%>%
  arrange(desc(num_of_items))%>%
  top_n(3)%>%
  knitr::kable()
```

## 1.4 Make a table showing the mean hour of the day at which Pink Lady Apples and Coffee Ice Cream are ordered on each day of the week
```{r}
  instacart %>%
  filter(product_name==c("Pink Lady Apples","Coffee Ice Cream"))%>%
  group_by(order_dow)%>%
  summarize(
    mean=mean(order_hour_of_day)
  )%>%
  knitr::kable()
```

There are `r nrow(instacart)` rows and `r ncol(instacart)` columns in data 'instacart'.
There are `r nrow(distinct(instacart, aisle))` distinct aisles. 
Some key variables include `r nrow(distinct(instacart, order_id))` distinct order_id and `r nrow(distinct(instacart, user_id))` distinct user_id.

# problem 2
## clean the data
```{r}
data("brfss_smart2010")
tidied_brfss=
  filter(brfss_smart2010,Topic=="Overall Health")%>%
  janitor::clean_names() %>%
  mutate(
    response=as.factor(response),
    response = forcats::fct_relevel(response, c("Poor","Fair","Good", "Very good","Excellent")))

```

## In 2002, which states were observed at 7 or more locations? What about in 2010?
```{r}
  separate(tidied_brfss,locationdesc,c("state","county"))%>%
  group_by(state,year)%>%
  summarise(n_location=n_distinct(county))%>%
  filter(n_location>=7, year==2002)%>%
  knitr::kable()

  separate(tidied_brfss,locationdesc,c("state","county"))%>%
  group_by(state,year)%>%
  summarise(n_location=n_distinct(county))%>%
  filter(n_location>=7, year==2010)%>%
  knitr::kable()
```

## Construct a dataset that is limited to Excellent responses, and contains, year, state, and a variable that averages the data_value across locations within a state. 

```{r}
brfss_new =
  tidied_brfss %>% 
  filter(response == "Excellent") %>% 
  group_by(year, locationabbr) %>% 
  mutate(mean = mean(data_value, na.rm = FALSE)) %>%
  select(year, locationabbr, mean) %>% 
  distinct() 
```

## Make a “spaghetti” plot 
```{r}
ggplot(brfss_new, aes(x = year, y = mean, color = locationabbr, group = locationabbr))+
  geom_line() +
  theme(legend.position="none") +
  xlab("Year") +
  ylab("The average value within a state") +
  ggtitle("The average value over time within a state")
```

## two-panel plot
```{r}
  tidied_brfss %>%
  filter(locationabbr=="NY",year %in% c(2006, 2010))%>%
  ggplot(aes(x = response, y = data_value )) +
  geom_boxplot(alpha = .5)+
  facet_grid(~year)+
  viridis::scale_fill_viridis(discrete = TRUE)
```

# problem 3
```{r}
accel_data=read_csv("./accel_data.csv")%>%
  pivot_longer(
    activity.1:activity.1440,
    names_to = "activity",
    values_to = "count"
  )
  
```

